# Production Configuration for Strategiz Auth API

# Server Configuration
server.port=${PORT:8080}
server.ssl.enabled=false
https.enabled=false

# Security
server.servlet.session.cookie.secure=true
server.servlet.session.cookie.same-site=None

# Custom Cookie Configuration for cross-origin AJAX with credentials
app.cookie.secure=true
app.cookie.same-site=None
app.cookie.domain=strategiz.io

# Firebase Configuration
firebase.database-url=${FIREBASE_DATABASE_URL:https://strategiz-io.firebaseio.com}
firebase.project-id=${FIREBASE_PROJECT_ID:strategiz-io}
firebase.service-account-key=${FIREBASE_SERVICE_ACCOUNT_KEY}
firebase.storage.bucket=${FIREBASE_STORAGE_BUCKET:strategiz-io.firebasestorage.app}

# Enable Vault in production
strategiz.vault.enabled=true
strategiz.vault.address=${STRATEGIZ_VAULT_ADDRESS:${VAULT_ADDR:https://strategiz-vault-43628135674.us-east1.run.app}}
strategiz.vault.cache-timeout-ms=60000
strategiz.vault.fail-fast=true
strategiz.vault.secrets-path=secret

# Spring Cloud Vault configuration
spring.cloud.vault.uri=${VAULT_ADDR:https://strategiz-vault-43628135674.us-east1.run.app}
spring.cloud.vault.token=${VAULT_TOKEN:}
spring.cloud.vault.kv.enabled=true
spring.cloud.vault.kv.backend=secret
spring.cloud.vault.kv.default-context=strategiz

# CORS Configuration
strategiz.cors.allowed-origins=https://auth.strategiz.io,https://strategiz-auth.web.app,https://strategiz.io,https://strategiz-io.web.app,https://console.strategiz.io,https://strategiz-console.web.app

# Logging
logging.level.root=INFO
logging.level.io.strategiz=INFO
logging.level.org.springframework.web=INFO
logging.level.org.springframework.security=INFO

# Actuator endpoints
management.endpoints.web.exposure.include=health,info,prometheus,metrics
management.endpoint.health.show-details=when-authorized
management.endpoint.prometheus.enabled=true
management.metrics.export.prometheus.enabled=true
management.metrics.tags.application=strategiz-auth

# ====================================================
# Grafana Cloud OpenTelemetry Configuration
# ====================================================
otel.exporter.otlp.endpoint=${GRAFANA_OTLP_ENDPOINT:https://otlp-gateway-prod-us-east-3.grafana.net/otlp}
otel.exporter.otlp.protocol=http/protobuf
otel.exporter.otlp.headers=Authorization=Basic ${GRAFANA_OTLP_AUTH_HEADER:}
otel.service.name=strategiz-auth
otel.resource.attributes=service.namespace=strategiz,deployment.environment=production,service.version=1.0.0
otel.traces.exporter=otlp
otel.traces.sampler=parentbased_traceidratio
otel.traces.sampler.arg=${OTEL_SAMPLING_RATIO:0.1}
otel.metrics.exporter=otlp
otel.logs.exporter=otlp
otel.propagators=tracecontext,baggage

# Micrometer tracing
management.tracing.enabled=true
management.tracing.sampling.probability=${OTEL_SAMPLING_RATIO:0.1}
management.tracing.propagation.type=W3C
management.metrics.distribution.percentiles-histogram.http.server.requests=true
management.metrics.distribution.slo.http.server.requests=50ms,100ms,200ms,500ms,1s,5s

# Application info
info.app.name=Strategiz Auth API
info.app.version=@project.version@
info.app.environment=production

# Frontend URL configuration
application.frontend-url=https://strategiz.io
frontend.url=https://strategiz.io
oauth.frontend-url=https://auth.strategiz.io

# Passkey Configuration for Production
passkey.rpId=strategiz.io
passkey.rpName=Strategiz
passkey.challengeTimeoutMs=60000

# OAuth Configuration (production)
oauth.providers.google.redirect-uri=https://auth-api.strategiz.io/v1/auth/oauth/google/signin/callback
oauth.providers.google.signup-redirect-uri=https://auth-api.strategiz.io/v1/auth/oauth/google/signup/callback
oauth.providers.google.auth-url=https://accounts.google.com/o/oauth2/auth
oauth.providers.google.token-url=https://oauth2.googleapis.com/token
oauth.providers.google.user-info-url=https://www.googleapis.com/oauth2/v3/userinfo
oauth.providers.google.scope=email profile openid

oauth.providers.facebook.redirect-uri=https://auth-api.strategiz.io/v1/auth/oauth/facebook/signin/callback
oauth.providers.facebook.signup-redirect-uri=https://auth-api.strategiz.io/v1/auth/oauth/facebook/signup/callback
oauth.providers.facebook.auth-url=https://www.facebook.com/v12.0/dialog/oauth
oauth.providers.facebook.token-url=https://graph.facebook.com/v12.0/oauth/access_token
oauth.providers.facebook.user-info-url=https://graph.facebook.com/me
oauth.providers.facebook.scope=email,public_profile

# Coinbase OAuth (for provider connections, not authentication)
oauth.providers.coinbase.redirect-uri=https://auth-api.strategiz.io/v1/providers/callback/cb
oauth.providers.coinbase.auth-url=https://www.coinbase.com/oauth/authorize
oauth.providers.coinbase.scope=wallet:accounts:read,wallet:transactions:read,wallet:buys:read,wallet:sells:read

# Disable development features
spring.devtools.enabled=false
spring.jpa.enabled=false
spring.main.allow-bean-definition-overriding=true

# Cache Configuration
spring.cache.type=jcache
spring.cache.jcache.config=classpath:ehcache.xml

# Performance optimizations
spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.default-property-inclusion=non_null

# Authorization Framework enabled
strategiz.authorization.enabled=true

# ====================================================
# SendGrid Email Configuration (for OTP emails)
# ====================================================
sendgrid.enabled=true
sendgrid.api.key=${SENDGRID_API_KEY:}
sendgrid.from.email=${SENDGRID_FROM_EMAIL:noreply@strategiz.io}
sendgrid.from.name=${SENDGRID_FROM_NAME:Strategiz}
app.frontend.url=https://strategiz.io

# ====================================================
# Twilio SMS Configuration (for SMS OTP)
# ====================================================
twilio.enabled=true
twilio.account-sid=${TWILIO_ACCOUNT_SID:}
twilio.auth-token=${TWILIO_AUTH_TOKEN:}
twilio.phone-number=${TWILIO_PHONE_NUMBER:}
twilio.mock-enabled=false
