<?xml version="1.0" encoding="UTF-8"?>
<config xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'
        xmlns='http://www.ehcache.org/v3'
        xsi:schemaLocation="http://www.ehcache.org/v3 http://www.ehcache.org/schema/ehcache-core-3.10.xsd">

    <!-- Market data bars cache - for historical OHLCV data -->
    <!-- TTL: 5 minutes for daily data, good balance between freshness and performance -->
    <cache alias="marketDataBars">
        <key-type>java.lang.String</key-type>
        <value-type>java.util.List</value-type>
        <expiry>
            <ttl unit="minutes">5</ttl>
        </expiry>
        <resources>
            <!-- Heap storage: up to 1000 entries (most frequently accessed symbols) -->
            <heap unit="entries">1000</heap>
            <!-- Off-heap storage: 50 MB for larger datasets -->
            <offheap unit="MB">50</offheap>
        </resources>
    </cache>

    <!-- Latest market data cache - for real-time-ish price updates -->
    <!-- TTL: 1 minute for fresher data -->
    <cache alias="latestMarketData">
        <key-type>java.lang.String</key-type>
        <value-type>io.strategiz.data.marketdata.entity.MarketDataEntity</value-type>
        <expiry>
            <ttl unit="minutes">1</ttl>
        </expiry>
        <resources>
            <heap unit="entries">500</heap>
        </resources>
    </cache>

    <!-- Available symbols cache - rarely changes, long TTL -->
    <cache alias="availableSymbols">
        <key-type>java.lang.String</key-type>
        <value-type>java.util.List</value-type>
        <expiry>
            <ttl unit="hours">1</ttl>
        </expiry>
        <resources>
            <heap unit="entries">1</heap>
        </resources>
    </cache>

    <!-- Market ticker cache - for landing page ticker data -->
    <!-- TTL: 30 seconds for reasonably fresh ticker data -->
    <cache alias="marketTicker">
        <key-type>java.lang.String</key-type>
        <value-type>org.springframework.http.ResponseEntity</value-type>
        <expiry>
            <ttl unit="seconds">30</ttl>
        </expiry>
        <resources>
            <heap unit="entries">1</heap>
        </resources>
    </cache>

    <!-- CoinGecko API caches - protect against rate limiting -->
    <!-- TTL: 60 seconds matches CoinGecko's data update frequency -->
    <cache alias="cryptoMarketData">
        <key-type>java.lang.String</key-type>
        <value-type>java.util.List</value-type>
        <expiry>
            <ttl unit="seconds">60</ttl>
        </expiry>
        <resources>
            <heap unit="entries">50</heap>
        </resources>
    </cache>

    <cache alias="cryptoSearch">
        <key-type>java.lang.String</key-type>
        <value-type>java.util.List</value-type>
        <expiry>
            <ttl unit="minutes">5</ttl>
        </expiry>
        <resources>
            <heap unit="entries">100</heap>
        </resources>
    </cache>

    <cache alias="topCryptos">
        <key-type>java.lang.String</key-type>
        <value-type>java.util.List</value-type>
        <expiry>
            <ttl unit="seconds">60</ttl>
        </expiry>
        <resources>
            <heap unit="entries">10</heap>
        </resources>
    </cache>

    <cache alias="globalMarketData">
        <key-type>java.lang.String</key-type>
        <value-type>java.util.Map</value-type>
        <expiry>
            <ttl unit="minutes">5</ttl>
        </expiry>
        <resources>
            <heap unit="entries">1</heap>
        </resources>
    </cache>

</config>
