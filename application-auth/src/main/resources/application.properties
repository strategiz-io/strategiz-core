# Strategiz Auth API - Base Application Properties
# Profile-specific configs are in application-prod.properties

# Spring Boot configuration
spring.application.name=strategiz-auth
server.port=${PORT:8082}

# Jackson configuration
spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.default-property-inclusion=non_null

# Logging
logging.level.root=INFO
logging.level.io.strategiz=DEBUG

# Bean definition overriding (required for RestTemplate bean conflicts)
spring.main.allow-bean-definition-overriding=true

# Firebase configuration
spring.cloud.gcp.project-id=strategiz-io
firebase.database.url=https://strategiz-io-default-rtdb.firebaseio.com
firebase.storage.bucket=strategiz-io.firebasestorage.app

# Actuator - expose health check and metrics
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=when-authorized

# Metrics
management.metrics.distribution.percentiles-histogram.http.server.requests=true
management.metrics.distribution.percentiles.http.server.requests=0.5,0.95,0.99
management.metrics.distribution.slo.http.server.requests=50ms,100ms,200ms,500ms,1s,2s,5s
management.metrics.tags.application=${spring.application.name}

# Cache Configuration
spring.cache.type=jcache
spring.cache.jcache.config=classpath:ehcache.xml

# ====================================================
# Vault Configuration (Dev)
# ====================================================
strategiz.vault.enabled=true
strategiz.vault.address=${VAULT_ADDR:http://127.0.0.1:8200}
strategiz.vault.cache-timeout-ms=60000
strategiz.vault.fail-fast=false
strategiz.vault.secrets-path=secret

spring.cloud.vault.uri=${VAULT_ADDR:http://127.0.0.1:8200}
spring.cloud.vault.token=${VAULT_TOKEN:root}
spring.cloud.vault.kv.enabled=true
spring.cloud.vault.kv.backend=secret
spring.cloud.vault.kv.default-context=strategiz

# ====================================================
# CORS Configuration (Dev)
# ====================================================
strategiz.cors.allowed-origins=http://localhost:3000,http://localhost:3001,http://localhost:3002,https://auth.strategiz.io,https://strategiz-auth.web.app,https://strategiz.io,https://strategiz-io.web.app

# ====================================================
# Cookie Configuration (Dev)
# ====================================================
app.cookie.domain=localhost
app.cookie.secure=false
app.cookie.same-site=Lax

# ====================================================
# OAuth Configuration (Dev)
# ====================================================
# Credentials loaded from Vault via VaultOAuthInitializer

# Google OAuth (dev)
oauth.providers.google.redirect-uri=http://localhost:8082/v1/auth/oauth/google/signin/callback
oauth.providers.google.signup-redirect-uri=http://localhost:8082/v1/auth/oauth/google/signup/callback
oauth.providers.google.auth-url=https://accounts.google.com/o/oauth2/auth
oauth.providers.google.token-url=https://oauth2.googleapis.com/token
oauth.providers.google.user-info-url=https://www.googleapis.com/oauth2/v3/userinfo
oauth.providers.google.scope=email profile openid

# Facebook OAuth (dev)
oauth.providers.facebook.redirect-uri=http://localhost:8082/v1/auth/oauth/facebook/signin/callback
oauth.providers.facebook.signup-redirect-uri=http://localhost:8082/v1/auth/oauth/facebook/signup/callback
oauth.providers.facebook.auth-url=https://www.facebook.com/v12.0/dialog/oauth
oauth.providers.facebook.token-url=https://graph.facebook.com/v12.0/oauth/access_token
oauth.providers.facebook.user-info-url=https://graph.facebook.com/me
oauth.providers.facebook.scope=email,public_profile

# OAuth Frontend URL for redirects after auth
oauth.frontend-url=http://localhost:3000

# ====================================================
# Passkey Configuration (dev)
# ====================================================
passkey.rpId=localhost
passkey.rpName=Strategiz Dev
passkey.challengeTimeoutMs=60000

# ====================================================
# Authorization Framework
# ====================================================
strategiz.authorization.enabled=true
